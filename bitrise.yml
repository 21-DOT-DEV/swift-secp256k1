---
format_version: '11'
default_step_lib_source: 'https://github.com/bitrise-io/bitrise-steplib.git'
project_type: other
trigger_map:
- pull_request_source_branch: '*'
  workflow: ENTRY-POINT
workflows:
  ENTRY-POINT:
    steps:
    - git-clone: {}
    - bitrise-run:
        title: Start Linux
        run_if: '{{ getenv "BITRISE_APP_SLUG" | eq "f1bbbdfeff08cd5c" }}'
        inputs:
        - workflow_id: LINUX
    - bitrise-run:
        title: Start macOS
        run_if: '{{ getenv "BITRISE_APP_SLUG" | ne "f1bbbdfeff08cd5c" }}'
        inputs:
        - workflow_id: MACOS
  LINUX:
    steps:
    # - script:
    #     title: docker-machine create
    #     deps:
    #       brew:
    #       - name: homebrew/cask/docker-toolbox
    #     inputs:
    #     - content: |-
    #         #!/usr/bin/env bash
    #         # fail if any commands fails; debug log
    #         set -ex
    #         # envman add --key BITRISE_XCODE_VERSION --value $(xcodebuild -version | sed -En 's/Xcode[[:space:]]+([0-9\.]*)/\1/p')
    #         # envman add --key BITRISE_MACOS_VERSION --value $(sw_vers -productVersion)

    #         docker-machine create --driver "virtualbox" default
    - script:
        title: docker build
        inputs:
        - content: |-
            #!/usr/bin/env bash
            # fail if any commands fails; debug log
            set -ex

            docker build .
  MACOS:
    steps:
    - swift-package-manager-test-for-mac: {}
